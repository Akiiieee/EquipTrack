<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Students - EquipTrack</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéì</text></svg>">
    <link rel="stylesheet" href="../../css/superadmin/dashboard.css">
    <link rel="stylesheet" href="../../css/superadmin/students.page.css">
</head>
<body>
    <header class="header" style="position:sticky; top:0; z-index:20;">
        <div class="header-content">
            <div class="logo" style="display:flex; align-items:center; gap:12px;">
                <h1>EquipTrack</h1>
            </div>
            <div class="user-info">
                <div class="welcome"><span id="username">Super Admin</span></div>
                <div class="avatar-wrap">
                    <div id="avatarCircle" class="avatar-circle" title="Profile"></div>
                    <div class="avatar-actions">
                        <button id="avatarOpen" class="icon-btn" title="Upload" aria-label="Upload">üì∑</button>
                        <button id="avatarRemove" class="icon-btn" title="Remove" aria-label="Remove">üóëÔ∏è</button>
                    </div>
                </div>
                <a href="#" class="logout-btn" onclick="logout()">Logout</a>
            </div>
        </div>
    </header>
    <div style="max-width:1400px; margin:0 auto; display:grid; grid-template-columns:260px 1fr; gap:24px; padding:24px;" class="layout-grid">
        <aside style="background:#fff; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.08); overflow:auto; position:sticky; top:90px; align-self:start; height:calc(100vh - 110px);">
            <div style="background:#800000; color:#fff; padding:18px 20px; font-weight:600;">Super Admin Panel</div>
            <nav style="padding:14px 10px;">
                <a href="dashboard.html" style="display:flex; align-items:center; gap:10px; padding:12px 12px; color:#333; text-decoration:none; border-radius:8px;">Dashboard</a>
                <a href="add_super_admin.html" style="display:flex; align-items:center; gap:10px; padding:12px 12px; color:#333; text-decoration:none; border-radius:8px;">Manage Super Admins</a>
                <a href="users.html" style="display:flex; align-items:center; gap:10px; padding:12px 12px; color:#333; text-decoration:none; border-radius:8px;">Users</a>
                <a href="departments.html" style="display:flex; align-items:center; gap:10px; padding:12px 12px; color:#333; text-decoration:none; border-radius:8px;">Departments</a>
                <a href="equipment.html" style="display:flex; align-items:center; gap:10px; padding:12px 12px; color:#333; text-decoration:none; border-radius:8px;">Equipment</a>
                <a href="students.html" style="display:flex; align-items:center; gap:10px; padding:12px 12px; color:#800000; text-decoration:none; border-radius:8px; background:#fff3bf;">Students <span style="margin-left:auto; background:#ffd60a; color:#800000; border-radius:999px; padding:2px 8px; font-size:12px; font-weight:700;" id="badgeStudents">0</span></a>
            </nav>
        </aside>
        <main>
            <div class="form-card" style="margin-top:0;">
                <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom: 15px;">
                    <h3 style="color:#800000; margin:0;">Manage Students</h3>
                    <div style="margin-left:auto; display:flex; gap:10px; align-items:center;">
                        <input type="text" id="studentSearch" placeholder="Search‚Ä¶" style="padding:10px 12px; border:2px solid #e9ecef; border-radius:8px; width:220px;">
                        <button id="openAddStudent" class="submit-btn" style="background:#ffd60a; color:#800000;">Add Student</button>
                    </div>
                </div>
                <div id="studentsTable" class="table-scroll">
                    <table style="width:100%; border-collapse: collapse;">
                        <thead>
                            <tr style="text-align:left; border-bottom:1px solid #eee;">
                                <th style="padding:8px;">Student ID</th>
                                <th style="padding:8px;">Name</th>
                                <th style="padding:8px;">Email</th>
                                <th style="padding:8px;">Program</th>
                                <th style="padding:8px;">RFID</th>
                                <th style="padding:8px;">Status</th>
                                <th style="padding:8px;">Created</th>
                                <th style="padding:8px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="studentsBody">
                            <tr><td colspan="8" style="padding:10px; color:#666;">Loading students‚Ä¶</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Add Student Modal -->
            <div id="addStudentModal" style="position:fixed; inset:0; background:rgba(0,0,0,.4); display:none; align-items:center; justify-content:center;">
                <div class="form-card" style="width:100%; max-width:520px;">
                    <h3 style="color:#800000; margin-bottom:12px;">Add Student</h3>
                    <form id="addStudentForm">
                        <div style="display:grid; gap:12px;">
                            <div>
                                <label>Student ID</label>
                                <input type="text" name="stud_id" required>
                            </div>
                            <div>
                                <label>Student Name</label>
                                <input type="text" name="stud_name" required>
                            </div>
                            <div>
                                <label>Email</label>
                                <input type="email" name="email" required>
                            </div>
                            <div>
                                <label>Program</label>
                                <select name="program" id="addStudentProgram" required>
                                    <option value="" disabled selected>Loading‚Ä¶</option>
                                </select>
                            </div>
                            <div class="message" id="addStudentMessage"></div>
                            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:6px;">
                                <button type="button" id="cancelAddStudent" class="submit-btn" style="background:#6c757d;">Cancel</button>
                                <button type="submit" class="submit-btn">Create</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Edit Student Modal -->
            <div id="editStudentModal" style="position:fixed; inset:0; background:rgba(0,0,0,.4); display:none; align-items:center; justify-content:center;">
                <div class="form-card" style="width:100%; max-width:520px;">
                    <h3 style="color:#800000; margin-bottom:12px;">Edit Student</h3>
                    <form id="editStudentForm">
                        <input type="hidden" name="id" />
                        <div style="display:grid; gap:12px;">
                            <div>
                                <label>Student ID</label>
                                <input type="text" name="stud_id" required>
                            </div>
                            <div>
                                <label>Student Name</label>
                                <input type="text" name="stud_name" required>
                            </div>
                            <div>
                                <label>Email</label>
                                <input type="email" name="email" placeholder="optional">
                            </div>
                            <div>
                                <label>Program</label>
                                <select name="program" id="editStudentProgram" required>
                                    <option value="" disabled selected>Loading‚Ä¶</option>
                                </select>
                            </div>
                            <div class="message" id="editStudentMessage"></div>
                            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:6px;">
                                <button type="button" id="cancelEditStudent" class="submit-btn" style="background:#6c757d;">Cancel</button>
                                <button type="submit" class="submit-btn">Save</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Complete Registration (RFID) Modal -->
            <div id="rfidModal" style="position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; align-items:center; justify-content:center;">
                <div class="form-card" style="width:100%; max-width:520px;">
                    <h3 style="color:#800000; margin-bottom:12px;">Complete Registration</h3>
                    <div style="color:#333; margin-bottom:10px;">Ask the student to tap their ID card on the 13.56MHz reader.</div>
                    <form id="rfidForm">
                        <input type="hidden" name="id" id="rfidStudentId">
                        <div>
                            <label>RFID</label>
                            <input type="text" id="rfidInput" name="rfid" placeholder="Tap card or type RFID" required>
                            <small style="color:#666;">Most readers type the code and press Enter automatically.</small>
                        </div>
                        <div class="message" id="rfidMessage"></div>
                        <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:12px;">
                            <button type="button" id="rfidCancel" class="submit-btn" style="background:#6c757d;">Cancel</button>
                            <button type="submit" class="submit-btn" style="background:#ffd60a; color:#800000;">Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <!-- Profile Modal (shared) -->
    <div id="profileModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3>Profile Picture</h3>
                <span class="close" onclick="closeProfileModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <div id="currentProfileDisplay" style="width: 120px; height: 120px; border-radius: 50%; background: #ffd60a; color: #800000; display: flex; align-items: center; justify-content: center; font-size: 48px; font-weight: bold; margin: 0 auto 15px; background-size: cover; background-position: center;"></div>
                    <p style="color: #666; margin: 0;">Current Profile Picture</p>
                </div>
                <form id="profileForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="profileImage">Upload New Picture</label>
                        <input type="file" id="profileImage" name="profile_image" accept="image/*" style="margin-bottom: 15px;">
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="cancel-btn" onclick="closeProfileModal()">Cancel</button>
                        <button type="submit" class="submit-btn" style="background: #ffd60a; color: #800000;">Update Profile</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirm & Toast -->
    <div id="confirmModal" style="position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; align-items:center; justify-content:center;">
        <div class="form-card" style="width:100%; max-width:420px;">
            <h3 id="confirmTitle" style="color:#800000; margin-bottom:10px;">Please Confirm</h3>
            <div id="confirmMessage" style="color:#333;">Are you sure?</div>
            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:14px;">
                <button type="button" id="confirmCancel" class="submit-btn" style="background:#6c757d;">Cancel</button>
                <button type="button" id="confirmOk" class="submit-btn">OK</button>
            </div>
        </div>
    </div>
    <div id="toastContainer" style="position: fixed; top: 18px; right: 18px; z-index: 9999; display: flex; flex-direction: column; gap: 10px;"></div>

    <script src="../../js/superadmin/students.page.js"></script>
</body>
</html>


